appId: "com.multiregionvpn"
---
# Verify Routing with Chrome
# Tests that Chrome actually routes through the VPN tunnel
# This is a REAL end-to-end test with a production browser

- launchApp

# Assign Chrome to UK tunnel
- tapOn:
    text: "Chrome"
    optional: true
- tapOn:
    text: '.*UK.*\(OpenVPN\)|.*UK.*|.*BBC.*'
    optional: true
- waitForAnimationToEnd

# Start VPN
- tapOn:
    point: "90%,8%"  # Toggle switch in top right
- waitForAnimationToEnd

# Should show Protected
- assertVisible: "Protected"

# Launch Chrome
- stopApp
- launchApp:
    appId: "com.android.chrome"
    clearState: false

# Navigate to IP check site
- tapOn:
    id: "url_bar"
    optional: true
- inputText: "ip-api.com/json"
- pressKey: Enter

# Wait for page to load (use a simple assertion with optional)
- assertVisible:
    text: ".*ip-api.*|United Kingdom|GB|country|city"
    optional: true

# Look for "GB" in the page content (UK country code)
- assertVisible:
    text: '"GB"|United Kingdom'
    optional: true

# ============================================
# Manual Verification Note
# ============================================
# This test can only PARTIALLY verify routing automatically.
# Manual steps:
# 1. Check if page shows "countryCode":"GB"
# 2. Verify city is in UK (London, Manchester, etc.)
# 3. If you see your local country, routing failed

# Return to VPN app
- stopApp
- launchApp:
    appId: "com.multiregionvpn"

# Turn off VPN
- tapOn:
    point: "90%,8%"  # Toggle switch in top right
- waitForAnimationToEnd
- assertVisible: "Disconnected"

