appId: "com.multiregionvpn"
---
# VPN Toggle Test
# Tests the VPN on/off toggle and status updates

- launchApp

# Verify initial state
- assertVisible:
    text: "Direct Internet|Local UK Diagnostic|Local FR Diagnostic|Region Router|App Routing Rules"

# Test: Toggle VPN ON
# Tap on the toggle switch by tapping near the status text (top right)
- tapOn:
    point: "90%,8%"  # Top right corner where toggle is

# Handle VPN permission dialog (if appears)
- tapOn:
    text: "OK"
    optional: true
- tapOn:
    text: "ALLOW"
    optional: true

# Wait for status to change
- waitForAnimationToEnd

# Status should change from Disconnected
- assertVisible:
    text: "Connecting|Protected|Error"  # Allow transient states

# Wait a few seconds for connection
- waitForAnimationToEnd

# If credentials and tunnel are configured, should show Protected
- assertVisible:
    text: "Protected|Error|Connecting"  # Allow transient states
    
# Test: Toggle VPN OFF
- tapOn:
    point: "90%,8%"  # Toggle switch in top right

# Wait for disconnection
- waitForAnimationToEnd

# Status should return to Disconnected
- assertVisible:
    text: "Disconnected|Error|Connecting"

# Test: Toggle ON again (verify it's stable)
- tapOn:
    point: "90%,8%"  # Toggle switch in top right
- waitForAnimationToEnd
- assertVisible:
    text: "Connecting|Protected|Error"

# Toggle OFF to clean up
- tapOn:
    point: "90%,8%"  # Toggle switch in top right
- waitForAnimationToEnd
- assertVisible:
    text: "Disconnected|Error"

