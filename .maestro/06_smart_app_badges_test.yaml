appId: "com.multiregionvpn"
---
# Smart App Badges Test
# Tests the smart ordering and badge system for geo-blocked apps

- launchApp

# Prerequisites: Tunnels must be configured (UK and FR)
- tapOn: "Tunnels"

# Test will FAIL if no UK or France tunnels are configured
- assertVisible:
    text: ".*UK.*|.*France.*"

# Navigate to Apps tab
- tapOn: "Apps"
- wait: 1000

# Test: Smart ordering
# Scroll to top to see priority apps
- scroll:
    direction: UP
    repeat: 5

# Geo-blocked apps should be near the top
# UK apps (if user is NOT in UK)
- assertVisible:
    text: "BBC iPlayer|ITVX|All 4"
    optional: true

# AU apps (if user is NOT in AU)
- assertVisible:
    text: "ABC iView|7plus|9Now"
    optional: true

# Test: Badge system
# Unconfigured foreign apps should have gray badges
# We can't directly check badge color, but we can verify the apps are there

# Test: Assign app to correct region
- scroll:
    direction: DOWN
    repeat: 3

- tapOn:
    text: "BBC iPlayer"
    optional: true

# Dialog should show tunnels
- assertVisible:
    text: "Select VPN Tunnel"
    optional: true

# Select UK tunnel
- tapOn:
    text: ".*UK.*"
    optional: true

# Test: Search functionality
- tapOn: "Search apps..."
- inputText: "netflix"
- assertVisible: "Netflix"

# Clear search
- clearText
- wait: 500

# Search for Disney
- inputText: "disney"
- assertVisible: "Disney"

# Clear search
- clearText

# Test: Scroll through app list
- scroll:
    direction: DOWN
    repeat: 10

# Multi-region apps should also be visible
- assertVisible:
    text: "Netflix|Spotify|Disney"
    optional: true

